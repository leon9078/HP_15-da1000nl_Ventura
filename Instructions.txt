Prerequirements:
- macOS environment
- empty 16+ GB USB flash drive for macOS Ventura
- empty 2+ GB USB flash drive for Arch

In a macOS environment:
- Download official Python package from python.org and install the ".pkg". Quit and reopen Terminal.
- Download macOS Ventura full installer using "installinstallmacos.py" (https://github.com/munki/macadmin-scripts)
- Download GPT fdisk (gdisk) tool

% cd ~/Music/
% git clone --depth 1 https://github.com/munki/macadmin-scripts.git
% cd macadmin-scripts
% sudo python3 installinstallmacos.py
[type the number of the macOS version you want to install]
% sudo chown -R $(whoami) *
% hdiutil attach -mountpoint mnt Install_macOS_13.7.7-22H722.dmg
% cp -R mnt/Install\ macOS\ Ventura.app /Applications/
% sudo sync
% hdiutil detach mnt
% mv Install_macOS_13.7.7-22H722.dmg ../
% cd ..
% rm -rf macadmin-scripts

Download GPT fdisk (gdisk) tool

% curl -L -o gdisk-1.0.10.pkg https://sourceforge.net/projects/gptfdisk/files/gptfdisk/1.0.10/gdisk-binaries/gdisk-1.0.10.pkg/download
% pkgutil --expand-full gdisk-1.0.10.pkg gdisk-1.0.10/
% mv gdisk-1.0.10/Payload/usr/local/bin/gdisk .
% rm -r gdisk-1.0.10*

Insert an empty 16+ GB USB flash drive

% diskutil list
% sudo ./gdisk /dev/rdiskX
n
[Enter, accept default Partition number]
[Enter, accept default First sector]
+600M
ef00
c
EFI System Partition
n
[Enter, accept default Partition number]
[Enter, accept default First sector]
[Enter, accept default Last sector]
[Enter, accept default AF00 Hex code]
c
2
[empty name (PARTLABEL)]
x
h
v

[The output MUST say "No problems found." and "available in 2 segments, the largest of which is 2014 [...] in size."]
[2014 sectors MUST BE the MINIMUM largest segment, so it COULD BE a larger number]

w
y

% sudo newfs_msdos -v EFI /dev/rdiskXs1
% sudo diskutil mount readOnly /dev/diskXs1
% diskutil umount /dev/diskXs1
% sudo newfs_hfs -J -v Ventura_Installer /dev/rdiskXs2
% diskutil mount nobrowse /dev/diskXs2
% sudo /Applications/Install\ macOS\ Ventura.app/Contents/Resources/createinstallmedia --volume /Volumes/Ventura_Installer --nointeraction
% sudo sync
% hdiutil detach /Volumes/Shared\ Support
% sudo rm -rf /Volumes/Install\ macOS\ Ventura/.{Spotlight-V100,fseventsd}
% diskutil umount /dev/diskXs2
% diskutil eject /dev/diskX

Unplug Ventura USB drive

Download Arch installer iso from official Arch website
% curl -O https://it.mirrors.cicku.me/archlinux/iso/2025.12.01/{archlinux-2025.12.01-x86_64.iso,sha256sums.txt}
% shasum -a 256 archlinux-2025.12.01-x86_64.iso | grep --color=yes "<paste SHA-256 of archlinux-2025.12.01.iso>"

Insert an empty 2+ GB USB flash drive

% diskutil list

Get the size of the Arch .iso and add 100 MiB in order to create a partition where the file system will have enough free space

% echo +$(( $(wc -c < archlinux-2025.12.01-x86_64.iso) / 2 ** 20 + 100 ))M

% sudo ./gdisk /dev/rdiskX
n
[Enter, accept default Partition number]
[Enter, accept default First sector]
[output of echo command]
ef00
v

[The output MUST say "No problems found." and "available in 2 segments, the largest of which is 2014 [...] in size."]
[2014 sectors MUST BE the MINIMUM largest segment, so it COULD BE a larger number]

w
y

% sudo newfs_msdos -v ARCH_202512 /dev/rdiskXs1
% sudo diskutil mount nobrowse /dev/diskXs1
% bsdtar -x -v --exclude EFI/BOOT/BOOTIA32.EFI --exclude boot/syslinux/ --exclude shellia32.efi -f archlinux-2025.12.01-x86_64.iso -C /Volumes/ARCH_202512
% perl -i -pe 's/(timeout).*/$1 5/;s/(beep).*/$1 off/' /Volumes/ARCH_202512/loader/loader.conf
% mv /Volumes/ARCH_202512/EFI/BOOT/{,ARCH-}BOOTx64.EFI
% cp /Volumes/ARCH_202512/shellx64.efi /Volumes/ARCH_202512/EFI/BOOT/BOOTx64.EFI
% curl -LJ -o /Volumes/ARCH_202512/EFI/BOOT/BIOS_settings.nsh https://github.com/leon9078/HP_15-da1000nl_Ventura/raw/master/BIOS/BIOS_settings.nsh
% curl -LJ -o /Volumes/ARCH_202512/EFI/TOOLS/uvt.efi --create-dirs https://github.com/leon9078/UefiVarTool/releases/download/1.0.0/uvt.efi
% printf '@echo -off\r\nARCH-BOOTx64.EFI\r\n' | perl -0777pe 's/(.)/$1\x00/gs;s/^/\xFF\xFE/' > /Volumes/ARCH_202512/EFI/BOOT/startup.nsh
% sudo sync
% diskutil umount /dev/diskXs1
% diskutil eject /dev/diskX

Unplug Arch USB drive

Before booting the Arch USB installer, make sure Ethernet cable or Android USB Tethering is disconnected!

Boot the Arch USB installer.
First, it will launch UEFI Shell, in 5 seconds it will automatically launch systemd-boot which, then, loads Arch Linux install menu.
If we press any key, except ESC, we skip the delay and boot immediately to systemd-boot.

Now, type "e" at initial boot screen:
module_blacklist=b43,b43legacy,bcm43xx,bcma,brcm80211,brcmfmac,brcmsmac,ssb nomodeset i915.modeset=0 nouveau.modeset=0 pcie_port_pm=off psmouse.synaptics_intertouch=1 quiet loglevel=0

# systemctl stop reflector systemd-{networkd-wait-online,timesyncd}
# systemctl disable reflector systemd-{networkd-wait-online,timesyncd}
# setfont ter-i16b

Connect Ethernet cable now, or Android USB Tethering

# pacman-key --init
# pacman-key --populate archlinux
# pacman -Sy
# pacman -S --noconfirm git
# git clone --depth 1 https://github.com/leon9078/HP_15-da1000nl_Ventura.git

Plug macOS Ventura USB installer

# lsblk -po +FSTYPE,LABEL,PARTLABEL,PARTTYPENAME
# mount -o nosuid,nodev,noexec,noatime,umask=0077,tz=UTC /dev/sdX1 /mnt
# cp -R HP_15-da1000nl_Ventura/EFI_USB /mnt/EFI
# sync
# umount /mnt
# eject /dev/sdX

Unplug macOS Ventura USB installer

# systemctl poweroff

Power on the laptop, at UEFI Shell press ESC key (within 5 seconds) to skip "startup.nsh" (which will otherwise load Arch systemd-boot).
At UEFI Shell prompt, we can simply type "bios_settings". UEFI Shell is case-insensitive, so we can type "bios_settings" instead of "BIOS_settings".
Also we can omit typing the script extension ".nsh"

Shell> bios_settings

After reboot, quickly unplug USB flash drive, wait for "Boot device not found" message. Plug again the Arch USB flash drive and reboot.
Again, at UEFI Shell press ESC key (within 5 seconds).

Go to this website on another device: https://time.is/UTC

Shell> date <month>/<day>/<year>
Shell> time <hours>:<minutes>:<seconds>
Shell> reset -s

Unplug Arch USB installer, attach empty NVMe SSD

Boot the PC, "Boot device not found", insert Arch USB installer.

Make sure Ethernet cable or Android USB Tethering is disconnected!

Ctrl-Alt-Del, F9, USB, UEFI Shell, Arch systemd-boot, "e", "module_blacklist=b43,b43legacy,bcm43xx,bcma,brcm80211,brcmfmac,brcmsmac,ssb nomodeset i915.modeset=0 nouveau.modeset=0 pcie_port_pm=off psmouse.synaptics_intertouch=1 quiet loglevel=0"

# systemctl stop reflector systemd-{networkd-wait-online,timesyncd}
# systemctl disable reflector systemd-{networkd-wait-online,timesyncd}
# setfont ter-i16b
# lsblk -po +FSTYPE,LABEL,PARTLABEL,PARTTYPENAME
# gdisk /dev/sdX
n
[Enter, accept default Partition number]
[Enter, accept default First sector]
+600M
ef00
c
EFI System Partition
n
[Enter, accept default Partition number]
[Enter, accept default First sector]
[Enter, accept default Last sector]
af00
c
2
[empty name (PARTLABEL)]
p
n
[Enter, accept default Partition number]
[value of End sector of partition number 2 + 1 sector]
[Enter, accept default Last sector]
0700
c
3
[empty name (PARTLABEL)]
x
h
v

[The output MUST say "No problems found." and "available in 2 segments, the largest of which is 2014 [...] in size."]
[2014 sectors MUST BE the MINIMUM largest segment, so it COULD BE a larger number]

w
y

# partprobe /dev/sdX
# systemctl poweroff

Unplug Arch USB installer, insert macOS Ventura USB installer.
Boot, F9, USB, "Install macOS Ventura (external)" will be automatically selected and booted in 5 seconds.
Type Cmd+Shift+T to quickly enter Terminal

# diskutil list
# newfs_msdos -v 'EFI' /dev/rdiskXs1
# diskutil mount readOnly /dev/diskXs1
# diskutil umount /dev/diskXs1
# newfs_hfs -J -v 'Macintosh HD' /dev/rdiskXs2
# diskutil mount diskXs2

Cmd-Q to quit Terminal

Install macOS Ventura to Macintosh HD.

There will be multiple reboots in the middle.
Reboot -> "macOS Installer" -> Reboot -> "macOS Installer" -> Reboot -> "Macintosh HD"
When you see "Macintosh HD" inside OpenCore Boot Menu, press Tab once to select "Shutdown"

Unplug macOS USB installer, plug Arch installer.

Make sure Ethernet is disconnected!

Boot, F9, USB, UEFI Shell, Arch systemd-boot, "e", "module_blacklist=b43,b43legacy,bcm43xx,bcma,brcm80211,brcmfmac,brcmsmac,ssb nomodeset i915.modeset=0 nouveau.modeset=0 pcie_port_pm=off psmouse.synaptics_intertouch=1 quiet loglevel=0"

# systemctl stop reflector systemd-{networkd-wait-online,timesyncd}
# systemctl disable reflector systemd-{networkd-wait-online,timesyncd}
# setfont ter-i16b

Connect Ethernet cable now, or Android USB Tethering

# pacman-key --init
# pacman-key --populate archlinux
# pacman -Sy
# pacman -S --noconfirm git
# git clone --depth 1 https://github.com/leon9078/HP_15-da1000nl_Ventura.git
# lsblk -po +FSTYPE,LABEL,PARTLABEL,PARTTYPENAME
# mount -o nosuid,nodev,noexec,noatime,umask=0077,tz=UTC /dev/sdX1 /mnt
# mkdir -p /mnt/EFI
# cp -R HP_15-da1000nl_Ventura/EFI_Target/* /mnt/EFI/
# sync
# umount /mnt
# gdisk /dev/sdX
d
3
w
y

# partprobe /dev/sdX
# efibootmgr -O
# for i in $(seq 9002 -1000 0); do efibootmgr -Bb $i 2> /dev/null; done
# for i in $(seq 9001 -1000 0); do efibootmgr -Bb $i 2> /dev/null; done
# for i in $(seq 9000 -1000 0); do efibootmgr -Bb $i 2> /dev/null; done
# systemctl poweroff

Unplug Arch USB, power on the PC, finish macOS install. Done!





Post-install
- Open Terminal
% cp /etc/zshrc ~/.zshrc
% chmod 600 ~/.zshrc
% perl -i -pe 's/(^PS1=).*/$1"%~ %# "/' ~/.zshrc
% printf '\n# Make sure line content is cleared from cursor position till the beginning of line when Ctrl-U is typed\nbindkey "^U" backward-kill-line\n' >> ~/.zshrc

Go to Terminal > Settings... > Profiles and select the profile you're using.

Go to the 'Window' tab:
- under 'Working directory or document', check 'Path'
- under 'Active process name', uncheck 'Arguments'
- check 'Profile name'

Go to the 'Tab' tab and under 'Active process name', uncheck 'Arguments'.

Go to the 'Shell' tab and under the 'Startup' heading, check 'Run command:' and enter into the box: login -fpql my_username /bin/zsh -l
Make sure 'Run inside shell' is unchecked.
If you have the 'Ask before closing: Only if there are processes other than the login shell and:' option selected, add 'login' and 'zsh' to the list of processes it will not prompt for.

% rm -rf ~/.zsh_sessions ; rm -f ~/.zsh_history ; kill -9 $$
